<!DOCTYPE html>
<html lang="en">
<head>
<title>Ultimate Meme Manager</title>
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, viewport-fit=cover"/>
<style>
  @font-face {
    font-family: 'Roboto';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: local('Roboto'), local('Roboto-Regular'), url('https://fonts.gstatic.com/s/roboto/v20/KFOmCnqEu92Fr1Mu4mxK.woff2') format('woff2');
  }

  [v-cloak] {
    display: none !important
  }

  #img {
    display: block;
    visibility: hidden;
    width: 100%;
  }
  .container {
    align-items: center;
    display: flex;
    justify-content: center;
    overflow: hidden;
    position: relative;
  }

  .container.container--might-drag {
    cursor: move; /* fallback if grab cursor is unsupported */
    cursor: grab;
    cursor: -moz-grab;
    cursor: -webkit-grab;
  }

  .container.container--might-drag.container--dragging {
    cursor: grabbing;
    cursor: -moz-grabbing;
    cursor: -webkit-grabbing;
  }

  #container div {
    background: transparent;
    box-sizing: border-box;
    border: 1px dashed #666;
    position: absolute;
    left: 0;
    margin: 0 auto;
    top: 0;
  }

  #container input:focus {
    outline: none;
  }

  .meme-text-input {
    border-radius: 5px;
    margin: 10px 0 0;
  }
</style>
<link rel="stylesheet" href="style.css"/>
</head>
<body>
<div id="app">
  <div class="webapp-cont">

    <button id="answer-example-share-button">Share file 5</button>
    <div id="output">
    </div>

    <script>

    function loadXHR(url) {
      return new Promise(function(resolve, reject) {
        try {
          var xhr = new XMLHttpRequest();
          xhr.open('GET', url);
          xhr.responseType = 'blob';
          xhr.onerror = function() {
            reject("Network error.");
          };
          xhr.onload = function() {
            if (xhr.status === 200) {
              resolve(xhr.response);
            } else {
              reject("Loading error:" + xhr.statusText);
            }
          };
          xhr.send();
        }
        catch(err) {
          reject(err.message)
        };
      });
    }

    function FileListItem(a) {
      a = [].slice.call(Array.isArray(a) ? a : arguments)
      for (var c, b = c = a.length, d = !0; b-- && d;) d = a[b] instanceof File
      if (!d) throw new TypeError("expected argument to FileList is File or array of File objects")
      for (b = (new ClipboardEvent("")).clipboardData || new DataTransfer; c--;) b.items.add(a[c])
      return b.files
    }

    loadXHR('memes/lester.jpg').then(function(theFblob) {
      document.getElementById('answer-example-share-button').onclick = function() {
        // let f = new File([blob], 'lester.jpg');
        if (navigator.share) {
/*          if (navigator.canShare && navigator.canShare({ files: filesArray })) {
            navigator.share({
              files: f,
              title: 'Vacation Pictures',
              text: 'Photos from September 27 to October 14.',
            })
            .then(function() {
              document.getElementById('output').innerHTML = 'Share was successful.';
            })
            .catch(function(error) {
              document.getElementById('output').innerHTML = JSON.stringify(error);
            });
          } else {
            document.getElementById('output').innerHTML = 'Your system doesn\'t support sharing files';
          }*/

          function blobToFile(theBlob, fileName) {
            //A Blob() is almost a File() - it's just missing the two properties below which we will add
            theBlob.lastModifiedDate = new Date();
            theBlob.name = fileName;
            return theBlob;
          }

          // const files = [blobToFile(theFblob, 'lester.jpg')];
          navigator.share({
            file: new File(['content'], 'sample1.txt'),
          })
            .then(function() {
              document.getElementById('output').innerHTML = 'Share was successful.';
            })
            .catch(function(error) {
              document.getElementById('output').innerHTML = JSON.stringify(error);
            });

        } else {
          document.getElementById('output').innerHTML = 'Your system doesn\'t support sharing files';
        }
      }
    });

    </script>

  </div>
</div>
</body>
</html>
